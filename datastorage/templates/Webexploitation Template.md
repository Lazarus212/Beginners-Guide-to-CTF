## General Template for Web Exploitation Category for Beginners

This is a template for identifying vulnerabilities in the web exploitation category. This template doesn't provide in depth support for solving tasks, rather providing the structure on how 
to identify and test for the most common vulnerabilities in the web exploitation category.

### 1. Initial Analysis
1. **Read the Task Description**
    - Carefully read the problem statement. Look for any hints or important details. (Oftentimes there are some hints hidden in it)
    - Check if there are some other problems that have already been solved.

2. **Explore the Website**
    - Open the provided URL in your browser.
    - Click around to see what pages are available and how the site is structured.
    - Open the developer tools by right-clicking and selecting "Inspect" additionally the page source can be opened, however this code is also available in the devtools

#### Tips for Beginners
- **Stay Organized**: Keep notes of what you try and what works.
- **Search for Resources**: Try to find similar problems that have already been solved.
- **Practice**: The more you practice, the better you’ll get at recognizing patterns and vulnerabilities.

### 2. Finding Hidden Content
Most commonly a hint for a flag is hidden in some files, sub-sites or directories that are not directly accessible. Additionally, in many events the network 
activity has to be analyzed to see requests that are not ordinary and sometimes can already contain the flag or the path to the flag. 

1. **Search for Hidden Directories and Files**
    - Use a tool like [`gobuster`](https://github.com/OJ/gobuster) (should already be installed with Kali Linux) to find hidden directories and files.
    - This tool can be used for a multitude of operations for example in dns mode, find different sub-sites. There are more use-cases described on the GitHub page.
    - Example output:

      ```
      gobuster dns -d google.com -w ~/wordlists/subdomains.txt
      ===============================================================
      Gobuster v3.2.0
      by OJ Reeves (@TheColonial) & Christian Mehlmauer (@firefart)
      ===============================================================
      [+] Mode         : dns
      [+] Url/Domain   : google.com
      [+] Threads      : 10
      [+] Wordlist     : /home/oj/wordlists/subdomains.txt
      ===============================================================
      2019/06/21 11:54:20 Starting gobuster
      ===============================================================
      Found: chrome.google.com
      Found: ns1.google.com
      Found: admin.google.com
      Found: www.google.com
      Found: m.google.com
      Found: support.google.com
      Found: translate.google.com
      Found: cse.google.com
      Found: news.google.com
      Found: music.google.com
      Found: mail.google.com
      Found: store.google.com
      Found: mobile.google.com
      Found: search.google.com
      Found: wap.google.com
      Found: directory.google.com
      Found: local.google.com
      Found: blog.google.com
      ===============================================================
      2019/06/21 11:54:20 Finished
      ===============================================================
      ```


2. **Looking at Network Traffic**
    - The quickest way to look at network traffic is via the developer tools of the browser the best browsers for this are `chrome` and `firefox`.
   The tools include at least basic functionality and headers can be viewed. 
    - For further analyzing traffic tools like [`OWASP ZAP`](https://www.zaproxy.org/) or [`Wireshark`](https://www.wireshark.org/) can be used, those require some more setup but have more in depth information.

### 3. Checking for Vulnerabilities
If no flag has been found yet there are some further steps that can be taken. The list has no particular ranking.

1. **Test for SQL Injection**
   - Find an input field or URL parameter to test.
   - Try entering a single quote (`'`), check if this results in an error. 
  
     This results in an error, because the user input doesn't get validated that there is no additional SQL. An exemplary request can look like this:
     ```SQL
     SELECT * FROM users WHERE username='''
     ```
     This is not a valid request, therefore the application crashes. 
   - If this is the case the first step is to see if the whole database can be accessed with entering `' OR 1=1`.
      
     This results in a SQL request looking like this:
     ```sql
     SELECT * FROM users WHERE username='' OR 1=1
     ```
     Which effectively results in:
     ```sql
     SELECT * FROM users WHERE username='' OR true
     ```
     returning the whole database.

   There is also a tool that can be used for automated testing:

   [`sqlmap`](https://sqlmap.org/)
   
   this tool can be used to test for more SQL related vulnerabilities and automatically dump the databases. 
2. **Test for XSS (Cross-Site Scripting)**
      
   Cross site scripting refers to maliciously using JavaScript to extract various data from a site.

   These test can be broken down into three categories. 
   1. Reflected XSS
        - Look for places where user input is reflected back on the page (e.g., search boxes, comments).
        - Try entering a simple script like 
            ```javascript
            <script>alert('XSS')</script>.
        - This script can be modified to fit the needs of the task
   
   2. Stored XSS 
      - In this scenario the payload gets loaded by the site itself. 
      - One example for this is having an option to comment. 
      
        In this example a malicious comment can be stored as payload, this comment gets distributed to every user of a website by loading the comments. This can be 
        exploited the same way as in the reflected XSS. 
   3. DOM XSS
      - Here the browser itself injects a XSS payload into the DOM, even if the server properly prevents XSS.
3. **Test for Command Injection**
   
   The goal here is to run system commands by injecting them through input fields.
    - Look for input fields or parameters that might run system commands.
    - Try entering `; ls`, depending on the system the command has to be switched to `$(ls)` or `'ls'` 
   
      The resulting command can look something like this
      ```shell
       example command ; ls
      ```
      This command executes both commands as they are separated by a semicolon. For finding a flag the `; ls ` part can be switched for every other commmand.
4. **Test for File Inclusion (LFI)**
      
      This exploit aims to manipulate the parameters in URLs to get access to files or start to remotely execute code. A detailed explanation is available from [OWASP](https://owasp.org/www-project-web-security-testing-guide/v42/4-Web_Application_Security_Testing/07-Input_Validation_Testing/11.1-Testing_for_Local_File_Inclusion)
    - Look for parameters that include file paths (e.g., `?page=home`).
    - Try entering `?page=../../etc/passwd` or `?page=http://example.com`.
5. **Test for Directory Traversal**
   
   This describes a scenario where user inputs are used in directory paths, and they are not properly sanitized. This can be used to access files that are not meant to be accessed.
   
   For example submitting:
   ```
   ../../../../../../../../etc/passwd
   ```
   instead of a real input. This input results in the path `/etc/passwd` as the operating system will not go to a directory above its file structure. 
   Leading to returning the content of the `passwd` file.


### 4. Exploiting Vulnerabilities
When a vulnerability is found and the flag is not already found. The next step is to further exploit it. This can be done by using some more advanced tools or just trying
different inputs. 

This template isn't made for going in depth for specific ways to solve a task for this other templates or tutorials have to be consulted. 

If the flag can't be found, try using a different method or look for another vulnerability. **Sometimes there are distractions and dead ends built in!**


### 5. Post-Exploitation
1. **Check for Additional Access**
    - If you gain access to a system, look for ways to escalate privileges or find more information.
    - Example: If you find a user account, look for passwords or other sensitive data.

2. **Document Your Steps**
    - Write down what you did, including the commands you used and the results you got.
    - Take screenshots if needed.

### 6. Submitting the Flag
1. **Submit the Flag**
    - Enter the flag into the CTF platform to get points.
    - Follow the competition rules for flag format and submission.

---

### Tools
- **Web Proxies**: [OWASP ZAP](https://www.zaproxy.org/), [Wireshark](https://www.wireshark.org/)
- **Directory/File Discovery**: [gobuster](https://github.com/OJ/gobuster)
- **SQL Injection**: [sqlmap](https://sqlmap.org/)
- **Miscellaneous**: [standard Linux commands](https://www.digitalocean.com/community/tutorials/linux-commands)

### Resources
1. **Overview**: 
  - [ctf101 web exploitation](https://ctf101.org/web-exploitation/overview/)
2. **Writeups**: 
  - [(Multiple)HTB Web Request](https://infosecwriteups.com/solving-the-htb-web-requests-ctf-challenge-ae22e898c77c)
  - [(SQL) Gone Dev](https://ctftime.org/writeup/21125)
  - [(SQL)  ringzer0ctf — SQLi challenges](https://eslam3kl.medium.com/ctf-ringzer0ctf-sqli-challenges-part-1-f06d9a3858ba)
  - [(XSS) Intigriti-XSS-Challenges](https://github.com/Sudistark/CTF-Writeups/blob/main/Intigriti-XSS-Challenges/2024/Jan.md?ref=weekly.infosecwriteups.com)
  - [(LFI) CVV #1: Local File Inclusion](https://infosecwriteups.com/cvv-1-local-file-inclusion-ebc48e0e479a)
  - [(Directory Traversal) Fetch the Flag CTF 2022 writeup: File Explorer](https://snyk.io/de/blog/fetch-the-flag-ctf-2022-writeup-file-explorer/)
